<html lang="en">

<head>
    <title>Server Send Event</title>
</head>

<body>
<h1>Events</h1>

<p id="text" style="font-size:40px;">Loading price...</p>

<script>
    const text = document.getElementById("text");

    const es = new EventSource("/events");
    es.onerror = (err) => {
        console.log("onerror", err)
    };

    es.onmessage = (msg) => {
        console.log("onmessage", msg)
    };

    es.onopen = (...args) => {
        console.log("onopen", args)
    };

    es.addEventListener("event-update", (event) => {
        const parsedData = JSON.parse(event.data);
        console.log(event)

        const data = parsedData.message;
        text.innerText = data;
    });
</script>
</body>

</html>